<?plantuml 1.2026.1?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="946px" preserveAspectRatio="none" style="width:753px;height:946px;background:#FFFFFF;" version="1.1" viewBox="0 0 753 946" width="753px" zoomAndPan="magnify"><title>Canonical Update Loop (t &#8594; t+1)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="255.5957" x="244.7976" y="27.9951">Canonical Update Loop (t &#8594; t+1)</text><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="World" id="part1-lifeline"><g><title>World</title><rect fill="#000000" fill-opacity="0.00000" height="747.3906" width="8" x="24.4702" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="28" x2="28" y1="118.5938" y2="865.9844"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="CS" id="part2-lifeline"><g><title>CapitalSelector</title><rect fill="#000000" fill-opacity="0.00000" height="747.3906" width="8" x="127.7651" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="131.4653" x2="131.4653" y1="118.5938" y2="865.9844"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="Stats" id="part3-lifeline"><g><title>EWMAStats</title><rect fill="#000000" fill-opacity="0.00000" height="747.3906" width="8" x="369.5698" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="373.5283" x2="373.5283" y1="118.5938" y2="865.9844"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="SM" id="part4-lifeline"><g><title>StackManager</title><rect fill="#000000" fill-opacity="0.00000" height="747.3906" width="8" x="483.6743" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="487.6113" x2="487.6113" y1="118.5938" y2="865.9844"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="SD" id="part5-lifeline"><g><title>SedimentDAG</title><rect fill="#000000" fill-opacity="0.00000" height="747.3906" width="8" x="681.1431" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="685.0952" x2="685.0952" y1="118.5938" y2="865.9844"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="World" id="part1-head"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.9404" x="5" y="115.292">World</text><ellipse cx="28.4702" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M28.4702,58.7969 L28.4702,85.7969 M15.4702,66.7969 L41.4702,66.7969 M28.4702,85.7969 L15.4702,100.7969 M28.4702,85.7969 L41.4702,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="World" id="part1-tail"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.9404" x="5" y="877.9795">World</text><ellipse cx="28.4702" cy="889.7813" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M28.4702,897.7813 L28.4702,924.7813 M15.4702,905.7813 L41.4702,905.7813 M28.4702,924.7813 L15.4702,939.7813 M28.4702,924.7813 L41.4702,939.7813" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="CS" id="part2-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120.5996" x="71.4653" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.5996" x="78.4653" y="107.292">CapitalSelector</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="CS" id="part2-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120.5996" x="71.4653" y="864.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.5996" x="78.4653" y="884.9795">CapitalSelector</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="Stats" id="part3-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94.083" x="326.5283" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.083" x="333.5283" y="107.292">EWMAStats</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="Stats" id="part3-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94.083" x="326.5283" y="864.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.083" x="333.5283" y="884.9795">EWMAStats</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="SM" id="part4-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114.126" x="430.6113" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.126" x="437.6113" y="107.292">StackManager</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="SM" id="part4-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114.126" x="430.6113" y="864.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.126" x="437.6113" y="884.9795">StackManager</text></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="SD" id="part5-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.0957" x="629.0952" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.0957" x="636.0952" y="107.292">SedimentDAG</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="SD" id="part5-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.0957" x="629.0952" y="864.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.0957" x="636.0952" y="884.9795">SedimentDAG</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="746.1909" x="0" y="149.1602"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="149.1602" y2="149.1602"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="152.1602" y2="152.1602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="79.1396" x="333.5256" y="138.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="60.6138" x="339.5256" y="154.6606">Observe</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#181818" points="119.7651,188.8594,129.7651,192.8594,119.7651,196.8594,123.7651,192.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.4702" x2="125.7651" y1="192.8594" y2="192.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.2949" x="35.4702" y="187.7935">r_k(t), c_k(t)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="746.1909" x="0" y="221.4258"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="221.4258" y2="221.4258"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="224.4258" y2="224.4258"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="153.3755" x="296.4077" y="210.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="134.8496" x="302.4077" y="226.9263">Compute Net Flow</text><g class="message" data-entity-1="part2" data-entity-2="part2" id="msg2"><line style="stroke:#181818;stroke-width:1;" x1="131.7651" x2="173.7651" y1="265.125" y2="265.125"/><line style="stroke:#181818;stroke-width:1;" x1="173.7651" x2="173.7651" y1="265.125" y2="278.125"/><line style="stroke:#181818;stroke-width:1;" x1="132.7651" x2="173.7651" y1="278.125" y2="278.125"/><polygon fill="#181818" points="142.7651,274.125,132.7651,278.125,142.7651,282.125,138.7651,278.125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4722" x="138.7651" y="260.0591">R_i(t), C_i(t), &#928;_i(t)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="746.1909" x="0" y="306.6914"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="306.6914" y2="306.6914"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="309.6914" y2="309.6914"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="144.895" x="300.6479" y="296.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="126.3691" x="306.6479" y="312.1919">Update Statistics</text><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg3"><polygon fill="#181818" points="361.5698,346.3906,371.5698,350.3906,361.5698,354.3906,365.5698,350.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="131.7651" x2="367.5698" y1="350.3906" y2="350.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.0762" x="138.7651" y="345.3247">update(&#928;_i(t))</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="746.1909" x="0" y="378.957"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="378.957" y2="378.957"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="381.957" y2="381.957"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="148.4053" x="298.8928" y="368.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="129.8794" x="304.8928" y="384.4575">Evaluate Stability</text><g class="message" data-entity-1="part2" data-entity-2="part2" id="msg4"><line style="stroke:#181818;stroke-width:1;" x1="131.7651" x2="173.7651" y1="422.6563" y2="422.6563"/><line style="stroke:#181818;stroke-width:1;" x1="173.7651" x2="173.7651" y1="422.6563" y2="435.6563"/><line style="stroke:#181818;stroke-width:1;" x1="132.7651" x2="173.7651" y1="435.6563" y2="435.6563"/><polygon fill="#181818" points="142.7651,431.6563,132.7651,435.6563,142.7651,439.6563,138.7651,435.6563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.0508" x="138.7651" y="417.5903">stable_i(t)</text></g><g class="message" data-entity-1="part4" data-entity-2="part4" id="msg5"><line style="stroke:#181818;stroke-width:1;" x1="487.6743" x2="529.6743" y1="464.7891" y2="464.7891"/><line style="stroke:#181818;stroke-width:1;" x1="529.6743" x2="529.6743" y1="464.7891" y2="477.7891"/><line style="stroke:#181818;stroke-width:1;" x1="488.6743" x2="529.6743" y1="477.7891" y2="477.7891"/><polygon fill="#181818" points="498.6743,473.7891,488.6743,477.7891,498.6743,481.7891,494.6743,477.7891" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6909" x="494.6743" y="459.7231">stable_S(t)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="746.1909" x="0" y="506.3555"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="506.3555" y2="506.3555"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="509.3555" y2="509.3555"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="184.5107" x="280.8401" y="495.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="165.9849" x="286.8401" y="511.856">Topology Maintenance</text><g class="message" data-entity-1="part4" data-entity-2="part4" id="msg6"><line style="stroke:#181818;stroke-width:1;" x1="487.6743" x2="529.6743" y1="550.0547" y2="550.0547"/><line style="stroke:#181818;stroke-width:1;" x1="529.6743" x2="529.6743" y1="550.0547" y2="563.0547"/><line style="stroke:#181818;stroke-width:1;" x1="488.6743" x2="529.6743" y1="563.0547" y2="563.0547"/><polygon fill="#181818" points="498.6743,559.0547,488.6743,563.0547,498.6743,567.0547,494.6743,563.0547" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.3931" x="494.6743" y="544.9888">dissolve unstable stacks</text></g><g class="message" data-entity-1="part4" data-entity-2="part5" id="msg7"><polygon fill="#181818" points="673.1431,588.1875,683.1431,592.1875,673.1431,596.1875,677.1431,592.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="487.6743" x2="679.1431" y1="592.1875" y2="592.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.4688" x="494.6743" y="587.1216">add_node(...) [if dissolved]</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="746.1909" x="0" y="620.7539"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="620.7539" y2="620.7539"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="623.7539" y2="623.7539"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="110.4272" x="317.8818" y="610.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91.9014" x="323.8818" y="626.2544">Reweighting</text><g class="message" data-entity-1="part2" data-entity-2="part2" id="msg8"><line style="stroke:#181818;stroke-width:1;" x1="131.7651" x2="173.7651" y1="664.4531" y2="664.4531"/><line style="stroke:#181818;stroke-width:1;" x1="173.7651" x2="173.7651" y1="664.4531" y2="677.4531"/><line style="stroke:#181818;stroke-width:1;" x1="132.7651" x2="173.7651" y1="677.4531" y2="677.4531"/><polygon fill="#181818" points="142.7651,673.4531,132.7651,677.4531,142.7651,681.4531,138.7651,677.4531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.2231" x="138.7651" y="659.3872">update weights (unless Freeze)</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="746.1909" x="0" y="706.0195"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="706.0195" y2="706.0195"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="709.0195" y2="709.0195"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="72.9951" x="336.5979" y="695.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="54.4692" x="342.5979" y="711.52">Rebirth</text><g class="message" data-entity-1="part2" data-entity-2="part2" id="msg9"><line style="stroke:#181818;stroke-width:1;" x1="131.7651" x2="173.7651" y1="749.7188" y2="749.7188"/><line style="stroke:#181818;stroke-width:1;" x1="173.7651" x2="173.7651" y1="749.7188" y2="762.7188"/><line style="stroke:#181818;stroke-width:1;" x1="132.7651" x2="173.7651" y1="762.7188" y2="762.7188"/><polygon fill="#181818" points="142.7651,758.7188,132.7651,762.7188,142.7651,766.7188,138.7651,762.7188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.8047" x="138.7651" y="744.6528">reset BehavioralState [if triggered]</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="746.1909" x="0" y="791.2852"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="791.2852" y2="791.2852"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="746.1909" y1="794.2852" y2="794.2852"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="182.9873" x="281.6018" y="780.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="164.4614" x="287.6018" y="796.7856">Invariant Enforcement</text><g class="message" data-entity-1="part2" data-entity-2="part2" id="msg10"><line style="stroke:#181818;stroke-width:1;" x1="131.7651" x2="173.7651" y1="834.9844" y2="834.9844"/><line style="stroke:#181818;stroke-width:1;" x1="173.7651" x2="173.7651" y1="834.9844" y2="847.9844"/><line style="stroke:#181818;stroke-width:1;" x1="132.7651" x2="173.7651" y1="847.9844" y2="847.9844"/><polygon fill="#181818" points="142.7651,843.9844,132.7651,847.9844,142.7651,851.9844,138.7651,847.9844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.2515" x="138.7651" y="829.9185">simplex, non-negativity</text></g><?plantuml-src NP9BJiCm48RtESM8LIgW4jjAHOAqHKW4909YWL0rJQRfgAuTsPFmE007u0ISY4Dm4Xmd1OMLBS__pJyF2uiYI50RpJagkAyA588hOog81RxVFq0EJqPHXBaO2m_6gYAgq0hdNA4ME4YmOa6LaQ9MSW3e8Cc6clb3UfO9YWlHS1iA_5E-JL5ZILs6BFqde89tf6LsTj75Pr4qdSBDof5j2ARJA9G6nwVUV09skOrbT0HvE8CqCRkgzgrTay12cUUMIR8zSBla02Jz-VKPBe7iPzAMpSwNvFxGqCe4wg28UwYZvWsgkkTMh5XUXuxEFolgNB8q94j_NxEzzvsfZ3BbAwJ8MaYZpaEtVqJ1pXdbPr3h3cvpv5ktbymcW4MnrAQWU3mUZ-2HrxzGyHHSRkcPkDm8wt9OPDSOT547SQqLEGSBI_H6evvTiPNDaBFa_9ZFQOCD6-j_XxHfMcUnNFebxvqlTOEMsnNFzThOdDeb_niKxof5BqVW_-Ynfj9leV7JZ7u0?></g></svg>